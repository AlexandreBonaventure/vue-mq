{"version":3,"file":"index.umd.min.js","sources":["../node_modules/string-convert/camel2hyphen.js","../node_modules/json2mq/index.js","../src/lib.js","../src/helpers.js","../src/utils.js","../src/component.js","../src/index.js"],"sourcesContent":["var camel2hyphen = function (str) {\n  return str\n          .replace(/[A-Z]/g, function (match) {\n            return '-' + match.toLowerCase();\n          })\n          .toLowerCase();\n};\n\nmodule.exports = camel2hyphen;","var camel2hyphen = require('string-convert/camel2hyphen');\n\nvar isDimension = function (feature) {\n  var re = /[height|width]$/;\n  return re.test(feature);\n};\n\nvar obj2mq = function (obj) {\n  var mq = '';\n  var features = Object.keys(obj);\n  features.forEach(function (feature, index) {\n    var value = obj[feature];\n    feature = camel2hyphen(feature);\n    // Add px to dimension features\n    if (isDimension(feature) && typeof value === 'number') {\n      value = value + 'px';\n    }\n    if (value === true) {\n      mq += feature;\n    } else if (value === false) {\n      mq += 'not ' + feature;\n    } else {\n      mq += '(' + feature + ': ' + value + ')';\n    }\n    if (index < features.length-1) {\n      mq += ' and '\n    }\n  });\n  return mq;\n};\n\nvar json2mq = function (query) {\n  var mq = '';\n  if (typeof query === 'string') {\n    return query;\n  }\n  // Handling array of media queries\n  if (query instanceof Array) {\n    query.forEach(function (q, index) {\n      mq += obj2mq(q);\n      if (index < query.length-1) {\n        mq += ', '\n      }\n    });\n    return mq;\n  }\n  // Handling single media query\n  return obj2mq(query);\n};\n\nmodule.exports = json2mq;","import {\n  subscribeToMediaQuery,\n  convertBreakpointsToMediaQueries,\n} from './helpers.js'\n\nexport default class MQ {\n  hasSetupListeners = false\n  listeners = new Set()\n  vm = null\n\n  constructor ({ breakpoints, defaultBreakpoint, Vue }) {\n    // Init reactive component\n    this.vm = new Vue({\n      data: () => ({\n        currentBreakpoint: defaultBreakpoint,\n        breakpoints,\n      }),\n      watch: {\n        breakpoints: {\n          deep: true,\n          handler: () => {\n            this.teardownListeners()\n            this.setupListeners()\n          },\n        },\n      },\n    })\n  }\n\n  setupListeners () {\n    if (!this.hasSetupListeners) {\n      const mediaQueries = convertBreakpointsToMediaQueries(this.vm.breakpoints)\n      // setup listeners\n      for (const key in mediaQueries) {\n        const mediaQuery = mediaQueries[key]\n        const enter = () => {\n          this.vm.currentBreakpoint = key\n        }\n        this.listeners.add(subscribeToMediaQuery(mediaQuery, enter))\n      }\n      this.hasSetupListeners = true\n    }\n  }\n\n  teardownListeners () {\n    for (const unsub of this.listeners) {\n      unsub()\n      this.listeners.delete(unsub)\n    }\n    this.hasSetupListeners = false\n  }\n\n  get api () {\n    const vm = this.vm\n    return {\n      get breakpoints () {\n        return vm.breakpoints\n      },\n      set breakpoints (val) {\n        vm.breakpoints = val\n      },\n      get current () {\n        return vm.currentBreakpoint\n      },\n    }\n  }\n}\n","import json2mq from 'json2mq'\n\nexport function convertBreakpointsToMediaQueries (breakpoints) {\n  const keys = Object.keys(breakpoints)\n  const values = keys.map(key => breakpoints[key])\n  const breakpointValues = [0, ...values.slice(0, -1)]\n  const mediaQueries = breakpointValues.reduce((sum, value, index) => {\n    const options = Object.assign(\n      {\n        minWidth: value,\n      },\n      index < keys.length - 1\n        ? { maxWidth: breakpointValues[index + 1] - 1 }\n        : {}\n    )\n    const mediaQuery = json2mq(options)\n    return Object.assign(sum, {\n      [keys[index]]: mediaQuery,\n    })\n  }, {})\n  return mediaQueries\n}\n\nexport function transformValuesFromBreakpoints (\n  breakpoints,\n  values,\n  currentBreakpoint\n) {\n  const findClosestValue = currentBreakpoint => {\n    if (values[currentBreakpoint] !== undefined) {\n      return values[currentBreakpoint]\n    }\n    const index = breakpoints.findIndex(b => b === currentBreakpoint)\n    const newBreakpoint =\n      index !== -1 || index !== 0 ? breakpoints[index - 1] : null\n    if (!newBreakpoint) return values[index]\n    return values[newBreakpoint] !== undefined\n      ? values[newBreakpoint]\n      : findClosestValue(newBreakpoint)\n  }\n  return findClosestValue(currentBreakpoint)\n}\n\nexport function selectBreakpoints (breakpoints, currentBreakpoint) {\n  const index = breakpoints.findIndex(b => b === currentBreakpoint)\n  return breakpoints.slice(index)\n}\n\nexport function subscribeToMediaQuery (mediaQuery, enter) {\n  const mql = window.matchMedia(mediaQuery)\n  const cb = ({ matches }) => {\n    if (matches) enter()\n  }\n  mql.addListener(cb) // subscribing\n  cb(mql) // initial trigger\n  return () => mql.removeListener(cb) // return unsubscribtion\n}\n","export function isArray (arg) {\n  return Object.prototype.toString.call(arg) === '[object Array]';\n}\n","// USAGE\n// mq-layout(mq=\"lg\")\n//   p Iâ€™m lg\nimport { selectBreakpoints } from './helpers'\nimport { isArray } from './utils'\nconst component = {\n  props: {\n    mq: {\n      required: true,\n      type: [String, Array],\n    },\n  },\n  computed: {\n    plusModifier () {\n      return !isArray(this.mq) && this.mq.slice(-1) === '+'\n    },\n    activeBreakpoints () {\n      const breakpoints = Object.keys(this.$mq.breakpoints)\n      const mq = this.plusModifier\n        ? this.mq.slice(0, -1)\n        : isArray(this.mq)\n          ? this.mq\n          : [this.mq]\n      return this.plusModifier ? selectBreakpoints(breakpoints, mq) : mq\n    },\n  },\n  render (h, props) {\n    const shouldRenderChildren = this.activeBreakpoints.includes(\n      this.$mq.current\n    )\n    return shouldRenderChildren ? h('div', this.$slots.default) : h()\n  },\n}\n\nexport default component\n","import { transformValuesFromBreakpoints } from './helpers.js'\nimport MQ from './lib.js'\nimport MqLayout from './component.js'\n\nconst DEFAULT_BREAKPOINTS = {\n  sm: 450,\n  md: 1250,\n  lg: Infinity,\n}\n\nconst install = function (\n  Vue,\n  { breakpoints = DEFAULT_BREAKPOINTS, defaultBreakpoint = 'sm' } = {}\n) {\n  const mq = new MQ({\n    breakpoints,\n    defaultBreakpoint,\n    Vue,\n  })\n  Vue.filter('mq', (api, values) => {\n    return transformValuesFromBreakpoints(\n      Object.keys(breakpoints),\n      values,\n      api.current\n    )\n  })\n  Vue.mixin({\n    beforeMount () {\n      mq.setupListeners()\n    },\n  })\n\n  Object.defineProperty(Vue.prototype, '$mq', {\n    get () {\n      return mq.api\n    },\n  })\n  if (process.env.NODE_ENV === 'test') {\n    // expose full lib\n    Vue.prototype.$mqLib = mq\n  }\n  Vue.prototype.$mqAvailableBreakpoints = mq.vm.breakpoints // DEPRECATION\n  Vue.component('MqLayout', MqLayout)\n}\n\nexport default { install }\n"],"names":["str","replace","match","toLowerCase","obj2mq","obj","mq","features","Object","keys","forEach","feature","index","value","test","isDimension","camel2hyphen","length","query","Array","q","MQ","breakpoints","defaultBreakpoint","Vue","Set","vm","data","currentBreakpoint","watch","deep","handler","_this","teardownListeners","setupListeners","values","breakpointValues","this","hasSetupListeners","mediaQueries","map","key","slice","reduce","sum","options","assign","minWidth","maxWidth","mediaQuery","json2mq","_this2","listeners","add","enter","mql","window","matchMedia","cb","matches","addListener","removeListener","subscribeToMediaQuery","unsub","delete","val","isArray","arg","prototype","toString","call","component","props","required","type","String","computed","plusModifier","activeBreakpoints","$mq","findIndex","b","selectBreakpoints","render","h","includes","current","$slots","default","DEFAULT_BREAKPOINTS","sm","md","lg","Infinity","install","filter","api","findClosestValue","undefined","newBreakpoint","transformValuesFromBreakpoints","mixin","beforeMount","defineProperty","get","process","env","NODE_ENV","$mqLib","$mqAvailableBreakpoints","MqLayout"],"mappings":"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"}